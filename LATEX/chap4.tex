\section{Key Management in Space DTNs}
\label{sec:survey}


The problem of key management is considered an open issue in DTNs \cite{menesidou2016automated}. This section focuses on the study of the proposed key management solution space DTNs.  The proposals were designed explicitly for space-based systems unless otherwise stated.



\subsection{Requirement for Key Management}

There are fundamental goals to any key management systems: secrecy of keys and assurance of purpose \cite{martineveryday}. DTNs present fundamental differences that make goals of protocols sometimes unclear or not simple to define. Routing is an example; in traditional networks, the purpose of routing is to select the best path between a source a destination. However, in space DTNs, connectivity is intermittent and propagation times are long. Hence the topology could change faster than topology updates propagation \cite{araniti2015contact}. Routing still consists in selecting the next hop until reaching a destination but the concept of best path is constrained.  The goal, in this case, could be to maximise the probability of bundle delivery.

Key management follows a similar problem. Many key management proposals evaluate the solutions using different metrics, and it seems that it is not clear the final requirements. For that reason, a new set of requirements is defined in this project. The new requirements complement the fundamental requirements mention before. These are classified into mandatory and optional. 

  
Most of the new requirements (REQ) are proposed by Templin \cite{templin-dtnskmreq-00}. Not all requirements are considered and two more are added. Nevertheless the ones omitted are discussed later. 



\begin{enumerate}
    \item Keys must be available when needed. The design must no relay on a query-response interaction between a source node and the trusted party or a destination node.
    \item The system must be trustworthy. There must be a trust anchor in the system; nodes cannot accept information directly from other nodes. 
    \item A single point of failure is not acceptable. Nodes cannot depend only on one entity, and some type of high availability must be present in the system.
    \item The system must support secure bootstrapping of nodes. The association between a node ID and its credentials must be certified before a node can use it in the DTN.
    \item The system must support delay tolerant key revocation. The system must be able to revoke credentials before the expiry date. 
    \item Credentials must be cached ``locally''. Space nodes must store credentials or the access to them should be subject to low delay and rarely disrupted links.
    \item The systems must be scalable. A space DTN could grow to thousands of nodes and the system must be capable of handling this situation. 
\end{enumerate}


The fundamental problem for DTN in space is that space nodes need authenticated information without online interaction with a CA, distribution centre or other nodes. Information refers to keys or some form of identification. The latter is employed in solution based on non-interactive protocols or Identity-Based-cryptography (IBC). Thus, the availability of authenticated information is the main problem for DTN nodes, and any key management system must solve (REQ 1).


\subsection{Analysis of current Key Management Solution}


The first question that arises is whether symmetric or asymmetric keys should be used to support a key management system.  The section  \ref{sec:space}concludes that symmetric keys are the most suitable solution for current space missions. However, for the Interplanetary Internet is expected a scenario similar to the terrestrial Internet \cite{rationale2010requirements} with multi-hop communications and cross organisational domains. Furthermore, policies, rights, hierarchy, and administrative groups should are part of the overall solution. Secure policies control resources usage, and bundle source and rights need to be identified. The network might scale to thousands of nodes, and different space agencies will participate in the network. Under this assumptions seems more suitable a key management solution similar to the Internet, symmetric keys might not be even acceptable in a cross-organisational domain \cite{ivancic2009security}.

The research effort so far is based on asymmetric keys and DTN working groups stated the need for automated systems for publication of public keys and revocations \cite{templin-dtnskmps-00}. Although there are ciphersuites based on symmetric keys in the Bundle Protocol Security Specification \cite{ietf-dtn-bpsec-07}, there is a common consensus that asymmetric keys will be the preferred method for the Interplanetary Internet. 

In public key management, a node must have an authenticated copy of the destination public key to encrypt the message, and the destination nodes must have the source node public key the verify the integrity. Key distribution is not a sensitive operation because the information is not secret. The common techniques are \textbf{pushing} from the key owner to the relying party and \textbf{pulling} from a usually trusted directory \cite{martineveryday}.

Low delays allow pushing and pulling, both to be effective on the Internet. For instance, TLS uses the pushing approach to retrieve the destination public key. After obtaining the public key, a node interacts with a Certificate Authority (CA) to check the validity of certificates. Alternatives for checking the validity are certificate revocation list CRL or the Online Certificate Status Protocol OCSP, but these requires interactions with the trusted authority which might not be feasible in deep space. Here should be noted as well that TLS, one of the most popular cryptographic protocol on Internet, uses a handshake between nodes to retrieve the public key and negotiate some parameters, protocols like this discourages for DTNs \cite{fall2003delay}.

There are modifications of OCSP, but these are designed to alleviate the overhead on certificates receivers but transfer the cost to nodes pulling the certificates. In Secure/Multi-purpose Internet Mail Extensions (S/MIME) sender could encapsulate its certificate as meta-data but the receiver is expected to validate it. S/MIME remove the communication between nodes but still require on-demands interactions with a trusted authority.

There are other alternatives to public keys based certificates. Templin \cite{templin-dtnskmps-00} states that web of trust might be an option for some types of DTNs, but more research should be done. For space-based networks, a model without a trusted authority is not acceptable. 

The other alternative is public key management based on Identity Based Cryptography IBC or Hierarchical Identity Based Cryptography HIBS. This approach eliminates the need for public certificates but introduces other issues on key revocation and key escrow. These problems can be addressed but no without adding overhead which questioned the benefits of IBC for DTNs. Farrell \textit{et al}. stated that IBC does not solve the problem \cite{irtf-dtnrg-sec-overview-06}; however, Asokan \cite{asokan2007towards} argue that IBC indeed solves the problem and provides an improvement in confidentiality services but not for authentication. In any case, proposal based on IBC are considered in this work.      


\subsection{Taxonomy of key Management in DTN}

A key management solution for DTN in space has the same requirement as any key management system plus extra considerations for the hostile environment. This section focuses on understanding why the problem is different from terrestrial networks as the Internet, define the requirements, and classify the solutions. 



Key management includes a wide range of processes which together provide security to cryptographic keys.  The problem of secure administration of cryptographic keys is complex but well-understood on terrestrial networks. Future space-based networks present two challenges to key management systems. Firstly, the network topology is dynamic; it consists of heterogeneous space nodes and planned communication links, opportunistic links might be available. Secondly, traditional cryptographic protocols are not suitable for this type of network, as mention in section \ref{sec:dtn}.

Menesidou \textit{et al.} \cite{menesidou2017cryptographic} classify key management schemes into three categories depending on whether the solution deal or not with secure initialization, key establishment, and key update/revocation. Key establishment is divided again into two groups: two-party and group communication. The same approach is adopted in this report. As this project aims to choose the most suitable key management scheme for the Interplanetary Internet, assumptions and benefits are scrutinised. The analysis considers proposals which focus only on key establishment because this is the fundamental problem for DTN in space.

\subsection{Standardisation effort}

Although the DTN working groups have been active since 2007, a key management specification has been postponed for many years, mainly for its complexity \cite{rfc6257}. Farrell present a DTN Key Management Requirements \cite{farrell-dtnrg-km-00}. However, this document is a high level document and does no establish concluding requirements for a key management solution. 


The first advance was a problem statement by Templin in 2014  \cite{templin-dtnskmps-00}. This internet-draft assumed that the solution involve some kind of public key cryptography and an automated system for publication of certificates and revocation lists. More important, the system must be designed to continue operation in the presence of long delays and intermittent connectivity and traditional key management protocols do not satisfy the requirements. The author suggest as well, the use of one-time keys, so each bundle is encrypted with a symmetric key encrypted by the destination public key. 

Another Internet-Draft more detailed was published by the same author one year later \cite{templin-dtnskmreq-00}. The document proposed nine requirements for a key management solution. The requirement include no single point of failure, multuopke points of authoprity and delay tolerant key revocation. The document also proposed four design criteria to match ensure that the solution match the requirements. Among these stand out the publisher/suscriber model instead of an online directory service and the multiple source of publications. 

Viswanathan \cite{viswanathan-dtn-pkdn-00} enumerates the possible communication patterns, data structure, architectural elements, and trust relationships.  This Internet-Draft provide a high level solution for key distribution and revocations using the publisher/subscriber pattern following the approach of previous documents.

Finally, a newly published document proposed the Delay-Tolerant Key Administration (DTKA) which is a system for key management intended for use in DTNs, particulary space-based communications. 



\subsection{A Survey of Key Management in space DTN}

In the beginning, the research effort focused on modify public certificates based solutions and IBC. Aaditeshwar and Keshav \cite{seth2005practical} proposed one of the first solutions. Their solution was designed for disconnected environments rather than specifically space-based networks. They argue that disconnected nodes cannot efficiently use PKI because this requires queries to a central or replicated database, and certificates revocations list are unsuitable for the excessive delay. The authors proposed a solution based on HIBC for creating secure channels providing mutual authentication and key revocation using a Private Key Generator as the trust anchor. 

Registration and establishment of system parameters require the exchange of several messages between the PKG, distribution agent and user, but this is done only one time. They proposed USB key storage devices to distribute symmetric keys from PKG to final users. For revocation, they used time-based keys where the PKG updates periodically every node with a new time-stamped private key. 
Comments: Cross-domain communication requires a lookup of the destination system parameters or the generation of the decryption key from the source node PKG and then send to destination node PKG. The proposal does not meet the REQ 3, 4, and 5.

Another solution based on IBC is proposed by Aniket \textit{et al.}\cite{kate2007anonymity}. This solution is more efficient than the previous one because a source node does not need to look up the public parameters of nodes in a different domain. Instead, it can use the root PKG parameters to communicate with any node in other domains. They also use a single-flow non-interactive key agreement scheme to exchange symmetric keys.  
Comments: This scheme presents the same problems as the previous one for key revocation, secure bootstrapping and single point of failure. However, the authors suggest a secret-share scheme instead of a single PKG. This paper is the only one that provides an alternative anonymity architecture, but this requires updating the domain PKG's master key and the renewal of all users private keys.  For space-based DTNs, anonymity is not a primary concern. In any case, there are other ways to achieve anonymity like the bundle in bundle encapsulation. \cite{ietf-dtn-bibect-00}.



An alternative scheme based on bilinear pairing is proposed by Xie and Wang \cite{xie2013practical}. They proposed a self-certified identity scheme and distributed key generation SCI-DKG that requires only an initial broadcast message rather than multiple interactions. Prior deployment, users obtain a digital ID card granted by a relevant authority and the system parameters. Each node generates its private key and distributes an initial message containing its credentials. When a node receives the initial message, it needs to verify if the signature matches with the credential, then compute a secret sharing and extract the encryption parameters. Comments: Unlike the previous proposals, this scheme provides secure bootstrapping REQ 4 but revocation in not supported REQ 3. Another issue is that the system is not scalable REQ 7.

Group key management is an option for multicast communication. This project does not focus on group communication, but a brief analysis is presented. Groups key management can be classified into centralised, decentralised and distributed. The most important security requirement for group key management are forward secrecy, backward secrecy, collusion freedom and key independence \cite{camtepe2005key}. 

Xu \textbf{et al.} \cite{xu2012chinese} proposed a group key management mechanism based on the Chinese Remainder Theorem for DTNs. The advantages are that the system does not need to broadcast messages when a node joins the domain, and only send one message when a node leaves the domain. A stateless scheme is used in this work to overcome delays and high error rates. For many to many communication, they add a lifetime to the group key to deal with users leaving the group. If a node does not receive the key update message at the corresponding interval, it can direct inquiry to a neighbour reducing the latency, but this is unacceptable for space-based networks REQ 2.

Another approach is proposed by Zhou \textbf{et al.} \cite{zhou2014autonomic} based on one-encryption multi-decryption key protocol for deep space. Authors claim that their scheme is more efficient than previous ones but the join and leave operation could be done without the authority in violation to REQ 2, although they argue that the operation has the property of forward-security and backward-security if the key independence condition holds. 


Van Vesien presented a solution using bilinear maps over elliptic curves \cite{van2010dynamic}. This work explain in details how the key exchange protocol works for each security block of the Bundle protocol. The author assumed that the protocol will be used to exchange keys for HMAC-SHA 1 authentication, RSA digital signature, and AES encryption. Nodes could be members of multiple groups, and only nodes in the same group can exchange keys. Initially, a group administrator calculates a value for each node using a master key and the node ID. Then the administrator provides the calculated value to each node before deployment. Two hosts can non-interactively establish a shared secret using a symmetric mapping function, the value provided by the group administrator, and the parameters containing key information. This proposal only focuses on key distribution, and there are no mentions of initialisation or revocation REQ 1,5. Scalability REQ 6 might be an issue because in practice nodes can only be member of two groups. 


For solving the key management problem, Jadhav \textbf{et al.} proposed using a time-evolving topologu model and two channel crytptography to design a non-interactive key exchange protocol. This protocol assumes two channel, one insecure and one secure usually called Out-Of-Band channel. 