\section{Key Management in Space DTNs}
\label{sec:survey}




The problem of key management is considered an open issue in DTNs. \cite{menesidou2016automated}.
This section focuses on the study of the proposed key management solution for space DTNs.  Some proposals were designed for space-based systems and others for general DTN.


%\subsection{Requirement for Key Management}


It is already complex to deploy key management systems in traditional networks. The problem lies in the deployment and management of the infrastructure to support authenticated keys and not cryptographic algorithms \cite{al2003certificateless}. For DTNs, the problem is even worst.


A Key management system has fundamental goals: secrecy of keys and assurance of purpose \cite{martineveryday}.  DTNs present fundamental differences with traditional networks that make goals of protocols sometimes unclear or not simple to define, key management is not the exception.

Considering routing in DTNs to illustrate the problem. The problem of defining the goals of routing in DTNs is analysed in many papers \cite{ivancic2009security,fall2003delay,araniti2015contact}. In traditional networks, the purpose of routing is to select the best path between a source a destination. Routing protocols utilise the network state to calculate the best path according to one or more metrics. In space DTNs, the lack of connectivity and long propagation delays make the goals of routing more complex. The topology could change faster than the time that requires disseminate the topology updates. Routing still consists of selecting the next best hop until the destination, but the concept of best path is constrained. In this case, maximise the probability of bundle delivery could be the goal. \cite{araniti2015contact}. 


Several key management schemes were evaluated for this report. Many of these schemes adopted different metrics and requirements. Thus, it seems that the problem is not well understood and the it is not requirements are not clear. The rest of the section present a detail study of the key management problem in DTNs.

\subsection{Analysis of current Key Management Solution}


The first question that arises is whether symmetric or asymmetric keys should be used to support a key management system.  The section  \ref{sec:space} concludes that symmetric keys are the most suitable solution for current space missions. 

For the Interplanetary Internet is expected a scenario similar to the terrestrial Internet \cite{rationale2010requirements}. Multi-hop communications and cross-organisational domains are enhancements of the current interplanetary communications. Also, policies, rights, hierarchy, and administrative groups form part of the overall solution. The network might scale to thousands of nodes, and different space agencies will participate in the network. Considering this scenario, it seems more suitable a key management solution similar to the Internet rather than one based on symmetric keys. Furthermore, symmetric keys might not be even acceptable in a cross-organisational domain \cite{ivancic2009security}.

The research effort so far is based on asymmetric keys and DTN working groups stated the need for automated systems for distribution of authenticated public keys and revocations mechanism \cite{templin-dtnskmps-00}. Although there are ciphersuites based on symmetric keys in the security specification BSP \cite{ietf-dtn-bpsec-07}, there is a common consensus that asymmetric keys will be the preferred method for the Interplanetary Internet. 

In public key cryptosystems, a node must have a copy of the destination public key to encrypt the message, and the destination nodes must have the source node public key to verify integrity. Key distribution is not a sensitive operation in the sense that information is not secret.  Common techniques  to obtain public keys are \textbf{pushing} directly from the key owner and \textbf{pulling} from a usually trusted directory \cite{martineveryday}.

Relatively low delays on the Internet allow pushing and pulling to be effective to obtain public keys. For instance, TLS uses the pushing approach to retrieve the destination public key. After obtaining the public key, a node needs to check the validity of certificates with a Certificate Authority CA. Popular options for this validation process are certificate revocation list CRL or the Online Certificate Status Protocol OCSP, but these options require interaction with the CA which might not be available in deep space communications. 

Here should be noted as well that TLS, one of the most popular cryptographic protocol on the Internet, uses a handshake between the parties to retrieve public keys and negotiate some parameters for the session. Negotiation based protocols are discouraged for DTNs \cite{fall2003delay,cerf2007delay}.

There are modifications of OCSP to improve the message overhead, but these are designed to alleviate the overhead on certificates receivers, but the overhead is transferred to the other side of the communication. In Secure/Multi-purpose Internet Mail Extensions (S/MIME) sender could encapsulate its certificate as meta-data, but the receiver is expected to validate the information. S/MIME remove the communication between nodes but still require on-demands interactions with a trusted authority. 

There are other alternatives to public key management based on certificates. Templin \cite{templin-dtnskmps-00} states that web of trust might be an option for some types of DTNs, but more research should be done. For space-based networks, a model without a trusted authority is not acceptable \cite{viswanathan-dtn-pkdn-00,burleigh-dtnwg-dtka-01,ivancic2009security}.  

Another alternative widely explored for public key management in DTNs is Identity Based Cryptography IBC. This approach uses a direct derivation of the public key from the node ID and eliminates the requirement of public certificates.  Even though IBC eliminates some problems inherent to the management of public certificates, it introduces other issues such as key escrow and key revocation. These problems can be addressed but no without adding considerably overhead which questioned the benefits of IBC for DTNs.


Farrell \textit{et al.} stated that IBC does not solve the problem of key management \cite{irtf-dtnrg-sec-overview-06}; however, Asokan \cite{asokan2007towards} argue that IBC indeed solves the problem and provides an improvement in confidentiality services but not for authentication. In any case, proposal based on IBC are considered in this work.   


\subsection{Taxonomy of key Management in DTN}

A key management solution for DTN in space has the same requirement as any key management system along with extra considerations for the hostile environment. This section focuses on understanding why the problem is different from terrestrial networks as the Internet, define the requirements, and classify the solutions. 



  Key management includes a wide range of processes which together provide security to cryptographic keys.  The problem of secure administration of cryptographic keys is complex but well-understood on terrestrial networks. Future space-based networks present two challenges to key management systems. Firstly, the network topology is dynamic; it consists of heterogeneous space nodes and planned communication links, opportunistic links might be available as well. Secondly, traditional cryptographic protocols are not suitable for this type of network; the latter problem is widely discussed in previous sections.% \ref{sec:dtn}.

Menesidou \textit{et al.} \cite{menesidou2017cryptographic} classify key management schemes into three categories depending on whether the solution deal or not with secure initialisation, key establishment, and revocation. Key establishment is divided again into two groups: two-party and group communication. The same approach is adopted in this report. As this project aims to choose the most suitable key management scheme for the Interplanetary Internet, assumptions and benefits are scrutinised. The analysis considers proposals which focus only on key establishment because this is the fundamental problem for DTN in space.

One objective of this project is analysing the proposed key management solutions for DTN. For that purpose, a set of requirements must be defined beforehand. Templin \cite{templin-dtnskmreq-00} presented for first time a set of formal requirements for a key management solution. Most of the requirements proposed by Templin are considered for this project. Some requirements such as multiple points of authority and no veto capabilities are excluded from the requirements defined in this project. Nevertheless, these omitted requirements are discussed in the section \ref{sec:evaluation}. Finally, two more requirements are added to the ones defined by Templin. 

It is worth to mention that these requirements complement the fundamental requirements for a key management system, and do not replace them. The new set of requirements REQ is listed below.
  


\begin{enumerate}
    \item Keys must be available when needed. The design must no relay on a query-response interaction between a source node and the trusted party or a destination node. This imply that credentials must be cached ``locally''. DTN nodes must store credentials locally or the access to them must be subject to low delay and rarely disrupted links using a sub-second one-way-light time.
    \item The system must be trustworthy. There must be a trust anchor in the system; nodes cannot accept information directly from other nodes, nor they can actively execute key management operations. Even if the operation is considered secure and nodes cannot fake messages, nodes could ``misbehave'' and drop updates or not collaborate with the protocol.
    \item A single point of failure is not acceptable. Nodes cannot depend only on the access to one entity,  some type of high availability must be present in the system.
    \item The system must support secure bootstrapping of nodes. The association between a node ID and its credentials must be certified before a node can use it in the DTN.
    \item The system must support delay tolerant key revocation. The system must have the capability to revoke credentials before the expiry date. 
    \item The systems must be scalable. A space DTN could grow to thousands of nodes and the system must be capable of handling this situation. 
\end{enumerate}


Adding to these requirement, there are characteristics that are highly desirable but not mandatory. These are 

low latency: The key management system should impose minimal latency in addition to the physical latency of the path
Low overhead: The key management system should not require more than a reasonable amount of messages exchange and storage. 
  

The fundamental problem for DTN in space is that space nodes require authenticated information without online interaction with a CA, distribution centre or other nodes. Information refers to keys or some form of identification. The latter is employed in solution based on non-interactive protocols or IBC. Thus, the availability of authenticated information is the main problem for DTN nodes, stated in REQ 1.




\subsection{Standardisation effort}

Even though DTN working groups have been active since 2007, a key management specification has been postponed for many years, mainly for its complexity \cite{rfc6257,irtf-dtnrg-sec-overview-06,templin-dtnskmps-00}. Farrell presents a high-level document for key management requirements \cite{farrell-dtnrg-km-00}, but this document does not establish concluding requirements for a solution. Only states that a solution must be compliant with the BSP, use well-known protocols and include solutions for manual keying, pre-shared keys and public keys.  


The first significant advance was a problem statement by Templin in 2014  \cite{templin-dtnskmps-00}. This internet-draft assumed that the solution involves some type of public key cryptography and an automated system for publication of certificates and revocation lists. More important, Templin affirmed that the system must be designed to continue operation in the presence of long delays and intermittent connectivity and traditional key management systems do not satisfy the requirements. The author suggests the use of one-time keys, so each bundle is encrypted with a symmetric key encrypted by the destination public key. 

Another Internet-Draft more detailed was published by the same author one year later \cite{templin-dtnskmreq-00}. The document proposed nine requirements for a key management solution. The requirements include no single point of failure, multiple points of authority and delay tolerant key revocation. The document also proposed four design criteria ensure that a solution matches with the requirements. For instance, the preference of a publisher/subscriber model instead of an online directory service and multiple sources of publications. 

Viswanathan \cite{viswanathan-dtn-pkdn-00} enumerates the possible communication patterns, data structure, architectural elements, and trust relationships.  This Internet-Draft provides a high-level solution for key distribution and revocations using the publisher/subscriber pattern, expanding the idea of previous documents.

Finally, a newly published document proposed the Delay-Tolerant Key Administration DTKA, which is a system for key management intended for the use in space-based DTNs. An overview of this system is presented in the next section.


\subsection{A Survey of Key Management in space DTN}

Aaditeshwar and Keshav \cite{seth2005practical} proposed one of the first key management systems for DTN. Their solution was designed for disconnected environments rather than space-based networks. They argue that disconnected nodes cannot efficiently use PKI because this requires queries to a central or replicated database, and certificates revocations list are unsuitable for the excessive delay. The authors proposed a solution based on HIBC for creating secure channels providing mutual authentication and key revocation. The Private Key Generator PKG is the trust anchor of the system, and there is one PKG per domain. Registration and establishment of system parameters require the exchange of several messages between the PKG, the distribution agent and DTN nodes, but this procedure is done only one time. The authors proposed USB key storage devices to distribute symmetric keys from PKG to final users. For revocation, they used time-based keys where the PKG updates periodically every node with a new time-stamped private key. 

This first key management system present some issues. Cross-domain communication requires a online look-up of the destination system parameters. Other option consist on the PKG of the source node generates the decryption key and then send to destination node PKG. The proposal does not meet the REQ 3, 4, and 5.


Another solution based on IBC is proposed by Aniket \textit{et al.}\cite{kate2007anonymity}. This solution is more efficient than the previous one because a source node does not need to look up the public parameters of DTN nodes in a different domain. Instead, it can use the root PKG parameters to communicate with any node in other domains. They also use a single-flow non-interactive key agreement scheme to exchange symmetric keys.

Although the last system is more efficient than the previous one, it fails to meet the same requirement, namely, key revocation, secure bootstrapping and single point of failure. However, the authors suggest a secret sharing scheme instead of using a single PKG to avoid a single point of failure. This paper is the only one that provides an alternative anonymity architecture, but this requires updating the domain PKG's master key, in consequence, it requires the renewal of all users private keys periodically. For space-based DTNs, anonymity is not stated as a requirement for space DTNs according to the CCSDS. \cite{book2011space}. In any case, the Bundle in Bundle Encapsulation \cite{ietf-dtn-bibect-00} already provides a way to achieve anonymity to some extent. 

Xie and Wang \cite{xie2013practical} propose a different approach based on bilinear pairing. They proposed a self-certified identity scheme and distributed key generation SCI-DKG that requires only an initial broadcast message rather than multiple interactions. Prior deployment, users obtain a digital ID card granted by a relevant authority and the system parameters. Each node generates its private key and distributes an initial message containing its credentials. When a node receives the initial message, it needs to verify if the signature matches with the credentials, then compute a secret sharing and extract the encryption parameters. Unlike the previous proposals, this scheme provides secure bootstrapping but revocation in not supported REQ 3. Another issue is that the system is not scalable REQ 7 and new DTN nodes receive information for other nodes and not from the trust anchor REQ 2.

Van Vesien presented a solution using bilinear maps over elliptic curves \cite{van2010dynamic}. This work is one of the few that explains in details how the key exchange protocol fit with the BSP specification. For instance, the author showed how the protocol could be used to exchange keys for HMAC-SHA 1 authentication, RSA digital signature, and AES encryption. Each node is members of one or more groups, and only nodes in the same group can non-interactively exchange keys. Initially, a group administrator calculates a value for each node using a master key and the node ID.  Then the administrator provides the calculated value to each node before deployment. Two hosts can non-interactively establish a shared secret using a symmetric mapping function, the value provided by the group administrator, and the parameters sent by the source containing key information. This proposal only focuses on key distribution, and there are no mentions of initialisation or revocation REQ 1 and 5. Scalability REQ 6 might be an issue because in practice a node can only be a member of two groups.


%For solving the key management problem, Jadhav \textbf{et al.} proposed using a time-evolving topology model and two channel cryptography to design a non-interactive key exchange protocol. This protocol assumes two channel, one insecure and one secure usually called Out-Of-Band OOB channel. The first stage is the bootstrap where the key owner present directly to the authority the authentication information and this could be easily checked. 

Lv \textbf{et al.} \cite{lv2014non} present another non-interactive key establishment solution for space DTNs. They used a time-evolving model for predicting contacts and exchange information such as key updates or revocation status. This model, combined with two-channel message authentication constitute the fundamental parts of the non-interactive key exchange protocol. In the bootstrapping stage, DTN nodes authenticate with a CA via an OOB channel providing secure initialisation. They claim that a proper OOB channel for a space DTN involves human interaction such as space missions authorities. In the exchange phase, a node sends its public key over an insecure channel like a radio signal to another node, then it calculates the hash of the public key and sends over the OOB channel. The receiver has to verify that the public key has not been modified. This solution requires an OOB channel in deep space. The authors suggest a laser emitter and a photo-sensor, but they stated that the design of an OOB channel is an open issue for space networks. Even if the development of laser technology is a promising technology for communication in space, it is unlikely that this will be used as a secure channel. Besides, there is no need to use the insecure channel if a secure OOB optical channel is available.  The key distribution and revocation is performed between DTN nodes in violation to REQ 2.  

Butha \textbf{et al.} \cite{bhutta2014efficient} present a key transport protocol to exchange symmetric keys which are compliant with the DTN architecture. They used a proxy signatures scheme which does not require a secure channel. This scheme is to provide the hop-by-hop authentication of the Bundle Authentication Block BAB. Each intermediate node validates the bundle, remove the BAB,  generates a new BAB using proxy signatures. The issue with this scheme is that the last version on the BSP eliminated the BAB.  The problem is that hop-by-hop authentication is difficult to achieve or impossible in some situations contemplated in the DTN architecture, so the overhead added by proxy signatures is not justifiable. REQ ??



The most recent proposal was published by the IETF \cite{burleigh-dtnwg-dtka-01} in 2018. The Architecture for Delay Tolerant Key Administration DTKA is a system of public keys management designed for space-based communication systems. This Internet draft is a full specification for the life-cycle of public keys in space-based DTN. The system adopt the publisher/subscriber model to proactively distributed public keys from the Key Agents to Key Users. The system also adopts a  multiple points of authority approach and no does not present single point of failure. 

Many Key Agents share the key authority role. DTN nodes register with the Key Authority through an OOB channel (for instance a physical channel). The Key Agents cooperate to generate bulletins with authenticated information such as new or revoked certificates. 

Key Agents distribute the bulletins using a t-n threshold scheme. Finally, nodes reassemble the bulletins and update their local database. All information in the bulletin is for future use, so nodes do not depend immediately on the bulletin. Scalability REQ 6 might be an issue for the DTKA. As this system is the one that satisfiy most of the requirements, a complete description is given at the end of the section.
%this topic is further discussed in the next section \ref{sec:evaluation}.  


Most of the proposal study in this section are based on traditional public certificates, Identity-based Cryptography or pairing cryptography. Rusch \textit{et al.}  \cite{rusch2017forward} proposed using puncturable encryption constructions for highly asynchronous scenarios. Their scheme ensures forward secrecy of messages at the cost of higher latency. In summary, recipients nodes repeatedly update the decryption keys to revoke decryption capabilities for selected time intervals, recipients or messages. The authors assumed that exist a PKI to exchange keys, but instead of RSA public keys, FSE public keys are used. No mention of initialisation or distribution is made on this work.


Group key management is an option for multicast communication. This project does not focus on group communication, but a brief analysis of some works is presented. Groups key management can be classified into centralised, decentralised and distributed. The most important security requirement for group key management are forward secrecy, backward secrecy, collusion freedom and key independence \cite{camtepe2005key}. 


Xu \textbf{et al.} \cite{xu2012chinese} proposed a group key management mechanism based on the Chinese Remainder Theorem for DTNs. The advantages are that the system does not need to broadcast messages when a node joins the domain, and only send one message when a node leaves the domain. A stateless scheme is used in this work to overcome delays and high error rates. For many to many communication, they add a lifetime to the group key to deal with users leaving the group. If a node does not receive the key update message at the corresponding interval, it can direct inquiry to a neighbour reducing the latency, but this is unacceptable for space-based networks REQ 2.

Another approach is proposed by Zhou \textbf{et al.} \cite{zhou2014autonomic} based on one-encryption multi-decryption key protocol for deep space. Authors claim that their scheme is more efficient than previous ones, but the join and leave operation could be done without the authority in violation of REQ 2. They argue that the operation has the property of forward-security and backward-security if the key independence condition holds.
 

\input{./table.tex}